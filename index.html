<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Google-api-php-client by chainoy</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Google-api-php-client</h1>
      <h2 class="project-tagline">A PHP client library for accessing Google APIs</h2>
      <a href="https://github.com/chainoy/google-api-php-client" class="btn">View on GitHub</a>
      <a href="https://github.com/chainoy/google-api-php-client/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/chainoy/google-api-php-client/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p><a href="https://travis-ci.org/google/google-api-php-client"><img src="https://travis-ci.org/google/google-api-php-client.svg?branch=master" alt="Build Status"></a></p>

<h1>
<a id="google-apis-client-library-for-php" class="anchor" href="#google-apis-client-library-for-php" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Google APIs Client Library for PHP</h1>

<h2>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Description</h2>

<p>The Google API Client Library enables you to work with Google APIs such as Google+, Drive, or YouTube on your server.</p>

<h2>
<a id="beta" class="anchor" href="#beta" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Beta</h2>

<p>This library is in Beta. We're comfortable enough with the stability and features of the library that we want you to build real production applications on it. We will make an effort to support the public and protected surface of the library and maintain backwards compatibility in the future. While we are still in Beta, we reserve the right to make incompatible changes.</p>

<h2>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requirements</h2>

<ul>
<li><a href="http://www.php.net/">PHP 5.4.0 or higher</a></li>
</ul>

<h2>
<a id="developer-documentation" class="anchor" href="#developer-documentation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Developer Documentation</h2>

<p><a href="http://developers.google.com/api-client-library/php">http://developers.google.com/api-client-library/php</a></p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<p>You can use <strong>Composer</strong> or simply <strong>Download the Release</strong></p>

<h3>
<a id="composer" class="anchor" href="#composer" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Composer</h3>

<p>The preferred method is via <a href="https://getcomposer.org">composer</a>. Follow the
<a href="https://getcomposer.org/doc/00-intro.md">installation instructions</a> if you do not already have
composer installed.</p>

<p>Once composer is installed, execute the following command in your project root to install this library:</p>

<div class="highlight highlight-source-shell"><pre>composer require google/apiclient:^2.0</pre></div>

<p>Finally, be sure to include the autoloader:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">require_once</span> <span class="pl-s"><span class="pl-pds">'</span>/path/to/your-project/vendor/autoload.php<span class="pl-pds">'</span></span>;</span></pre></div>

<h3>
<a id="download-the-release" class="anchor" href="#download-the-release" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Download the Release</h3>

<p>If you abhor using composer, you can download the package in its entirety. The <a href="https://github.com/google/google-api-php-client/releases">Releases</a> page lists all stable versions. Download any file
with the name <code>google-api-php-client-[RELEASE_NAME].zip</code> for a package including this library and its dependencies.</p>

<p>Uncompress the zip file you download, and include the autoloader in your project:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">require_once</span> <span class="pl-s"><span class="pl-pds">'</span>/path/to/google-api-php-client/vendor/autoload.php<span class="pl-pds">'</span></span>;</span></pre></div>

<p>For additional installation and setup instructions, see <a href="https://developers.google.com/api-client-library/php/start/installation">the documentation</a>.</p>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>

<p>See the <a href="examples"><code>examples/</code></a> directory for examples of the key client features. You can
view them in your browser by running the php built-in web server.</p>

<pre><code>$ php -S localhost:8000 -t examples/
</code></pre>

<p>And then browsing to the host and port you specified
(in the above example, <code>http://localhost:8000</code>).</p>

<h3>
<a id="basic-example" class="anchor" href="#basic-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Basic Example</h3>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// include your composer dependencies</span></span>
<span class="pl-s1"><span class="pl-k">require_once</span> <span class="pl-s"><span class="pl-pds">'</span>vendor/autoload.php<span class="pl-pds">'</span></span>;</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Client</span>();</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setApplicationName(<span class="pl-s"><span class="pl-pds">"</span>Client_Library_Examples<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setDeveloperKey(<span class="pl-s"><span class="pl-pds">"</span>YOUR_APP_KEY<span class="pl-pds">"</span></span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$service</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Books</span>(<span class="pl-smi">$client</span>);</span>
<span class="pl-s1"><span class="pl-smi">$optParams</span> <span class="pl-k">=</span> <span class="pl-c1">array</span>(<span class="pl-s"><span class="pl-pds">'</span>filter<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>free-ebooks<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$results</span> <span class="pl-k">=</span> <span class="pl-smi">$service</span><span class="pl-k">-&gt;</span><span class="pl-smi">volumes</span><span class="pl-k">-&gt;</span>listVolumes(<span class="pl-s"><span class="pl-pds">'</span>Henry David Thoreau<span class="pl-pds">'</span></span>, <span class="pl-smi">$optParams</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-k">foreach</span> (<span class="pl-smi">$results</span> <span class="pl-k">as</span> <span class="pl-smi">$item</span>) {</span>
<span class="pl-s1">  <span class="pl-c1">echo</span> <span class="pl-smi">$item</span>[<span class="pl-s"><span class="pl-pds">'</span>volumeInfo<span class="pl-pds">'</span></span>][<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>], <span class="pl-s"><span class="pl-pds">"</span>&lt;br /&gt; <span class="pl-cce">\n</span><span class="pl-pds">"</span></span>;</span>
<span class="pl-s1">}</span></pre></div>

<h3>
<a id="authentication-with-oauth" class="anchor" href="#authentication-with-oauth" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authentication with OAuth</h3>

<blockquote>
<p>An example of this can be seen in <a href="examples/simple-file-upload.php"><code>examples/simple-file-upload.php</code></a>.</p>
</blockquote>

<ol>
<li>Follow the instructions to <a href="https://developers.google.com/api-client-library/php/auth/web-app#creatingcred">Create Web Application Credentials</a>
</li>
<li>Download the JSON credentials</li>
<li>
<p>Set the path to these credentials using <code>Google_Client::setAuthConfig</code>:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Client</span>();</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setAuthConfig(<span class="pl-s"><span class="pl-pds">'</span>/path/to/client_credentials.json<span class="pl-pds">'</span></span>);</span></pre></div>
</li>
<li>
<p>Set the scopes required for the API you are going to call</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>addScope(<span class="pl-c1">Google_Service_Drive</span><span class="pl-k">::</span><span class="pl-c1">DRIVE</span>);</span></pre></div>
</li>
<li>
<p>Set your application's redirect URI</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// Your redirect URI can be any registered URI, but in this example</span></span>
<span class="pl-s1"><span class="pl-c">// we redirect back to this same page</span></span>
<span class="pl-s1"><span class="pl-smi">$redirect_uri</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>http://<span class="pl-pds">'</span></span> <span class="pl-k">.</span> <span class="pl-smi">$_SERVER</span>[<span class="pl-s"><span class="pl-pds">'</span>HTTP_HOST<span class="pl-pds">'</span></span>] <span class="pl-k">.</span> <span class="pl-smi">$_SERVER</span>[<span class="pl-s"><span class="pl-pds">'</span>PHP_SELF<span class="pl-pds">'</span></span>];</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setRedirectUri(<span class="pl-smi">$redirect_uri</span>);</span></pre></div>
</li>
<li>
<p>In the script handling the redirect URI, exchange the authorization code for an access token:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-k">if</span> (<span class="pl-c1">isset</span>(<span class="pl-smi">$_GET</span>[<span class="pl-s"><span class="pl-pds">'</span>code<span class="pl-pds">'</span></span>])) {</span>
<span class="pl-s1">    <span class="pl-smi">$token</span> <span class="pl-k">=</span> <span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>fetchAccessTokenWithAuthCode(<span class="pl-smi">$_GET</span>[<span class="pl-s"><span class="pl-pds">'</span>code<span class="pl-pds">'</span></span>]);</span>
<span class="pl-s1">    <span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setAccessToken(<span class="pl-smi">$token</span>);</span>
<span class="pl-s1">}</span></pre></div>
</li>
</ol>

<h3>
<a id="authentication-with-service-accounts" class="anchor" href="#authentication-with-service-accounts" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Authentication with Service Accounts</h3>

<blockquote>
<p>An example of this can be seen in <a href="examples/service-account.php"><code>examples/service-account.php</code></a>.</p>
</blockquote>

<ol>
<li>Follow the instructions to <a href="https://developers.google.com/api-client-library/php/auth/service-accounts#creatinganaccount">Create a Service Account</a>
</li>
<li>Download the JSON credentials</li>
<li>
<p>Set the path to these credentials using the <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c1">putenv</span>(<span class="pl-s"><span class="pl-pds">'</span>GOOGLE_APPLICATION_CREDENTIALS=/path/to/service-account.json<span class="pl-pds">'</span></span>);</span></pre></div>
</li>
<li>
<p>Tell the Google client to use your service account credentials to authenticate:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Client</span>();</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>useApplicationDefaultCredentials();</span></pre></div>
</li>
<li>
<p>Set the scopes required for the API you are going to call</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>addScope(<span class="pl-c1">Google_Service_Drive</span><span class="pl-k">::</span><span class="pl-c1">DRIVE</span>);</span></pre></div>
</li>
<li>
<p>If you have delegated domain-wide access to the service account and you want to impersonate a user account, specify the email address of the user account using the method setSubject:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setSubject(<span class="pl-smi">$user_to_impersonate</span>);</span></pre></div>
</li>
</ol>

<h3>
<a id="making-requests" class="anchor" href="#making-requests" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Making Requests</h3>

<p>The classes used to call the API in <a href="https://github.com/Google/google-api-php-client-services">google-api-php-client-services</a> are autogenerated. They map directly to the JSON requests and responses found in the <a href="https://developers.google.com/apis-explorer/#p/">APIs Explorer</a>.</p>

<p>A JSON request to the <a href="https://developers.google.com/apis-explorer/#p/datastore/v1beta3/datastore.projects.runQuery">Datastore API</a> would look like this:</p>

<div class="highlight highlight-source-json"><pre>POST https://datastore.googleapis.com/v<span class="pl-c1">1</span>beta<span class="pl-c1">3</span>/projects/YOUR_PROJECT_ID:runQuery?key=YOUR_API_KEY

{
    <span class="pl-s"><span class="pl-pds">"</span>query<span class="pl-pds">"</span></span>: {
        <span class="pl-s"><span class="pl-pds">"</span>kind<span class="pl-pds">"</span></span>: [{
            <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>Book<span class="pl-pds">"</span></span>
        }],
        <span class="pl-s"><span class="pl-pds">"</span>order<span class="pl-pds">"</span></span>: [{
            <span class="pl-s"><span class="pl-pds">"</span>property<span class="pl-pds">"</span></span>: {
                <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span>
            },
            <span class="pl-s"><span class="pl-pds">"</span>direction<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>descending<span class="pl-pds">"</span></span>
        }],
        <span class="pl-s"><span class="pl-pds">"</span>limit<span class="pl-pds">"</span></span>: <span class="pl-c1">10</span>
    }
}</pre></div>

<p>Using this library, the same call would look something like this:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// create the datastore service class</span></span>
<span class="pl-s1"><span class="pl-smi">$datastore</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore</span>(<span class="pl-smi">$client</span>)</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// build the query - this maps directly to the JSON</span></span>
<span class="pl-s1"><span class="pl-smi">$query</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_Query</span>([</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>kind<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">        [</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>Book<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        ],</span>
<span class="pl-s1">    ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>order<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>property<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> [</span>
<span class="pl-s1">            <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">        ],</span>
<span class="pl-s1">        <span class="pl-s"><span class="pl-pds">'</span>direction<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>descending<span class="pl-pds">'</span></span>,</span>
<span class="pl-s1">    ],</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>limit<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">10</span>,</span>
<span class="pl-s1">]);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// build the request and response</span></span>
<span class="pl-s1"><span class="pl-smi">$request</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_RunQueryRequest</span>([<span class="pl-s"><span class="pl-pds">'</span>query<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-smi">$query</span>]);</span>
<span class="pl-s1"><span class="pl-smi">$response</span> <span class="pl-k">=</span> <span class="pl-smi">$datastore</span><span class="pl-k">-&gt;</span><span class="pl-smi">projects</span><span class="pl-k">-&gt;</span>runQuery(<span class="pl-s"><span class="pl-pds">'</span>YOUR_DATASET_ID<span class="pl-pds">'</span></span>, <span class="pl-smi">$request</span>);</span></pre></div>

<p>However, as each property of the JSON API has a corresponding generated class, the above code could also be written like this:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// create the datastore service class</span></span>
<span class="pl-s1"><span class="pl-smi">$datastore</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore</span>(<span class="pl-smi">$client</span>)</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// build the query</span></span>
<span class="pl-s1"><span class="pl-smi">$request</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_RunQueryRequest</span>();</span>
<span class="pl-s1"><span class="pl-smi">$query</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_Query</span>();</span>
<span class="pl-s1"><span class="pl-c">//   - set the order</span></span>
<span class="pl-s1"><span class="pl-smi">$order</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_PropertyOrder</span>();</span>
<span class="pl-s1"><span class="pl-smi">$order</span><span class="pl-k">-&gt;</span>setDirection(<span class="pl-s"><span class="pl-pds">'</span>descending<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$property</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_PropertyReference</span>();</span>
<span class="pl-s1"><span class="pl-smi">$property</span><span class="pl-k">-&gt;</span>setName(<span class="pl-s"><span class="pl-pds">'</span>title<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$order</span><span class="pl-k">-&gt;</span>setProperty(<span class="pl-smi">$property</span>);</span>
<span class="pl-s1"><span class="pl-smi">$query</span><span class="pl-k">-&gt;</span>setOrder([<span class="pl-smi">$order</span>]);</span>
<span class="pl-s1"><span class="pl-c">//   - set the kinds</span></span>
<span class="pl-s1"><span class="pl-smi">$kind</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Service_Datastore_KindExpression</span>();</span>
<span class="pl-s1"><span class="pl-smi">$kind</span><span class="pl-k">-&gt;</span>setName(<span class="pl-s"><span class="pl-pds">'</span>Book<span class="pl-pds">'</span></span>);</span>
<span class="pl-s1"><span class="pl-smi">$query</span><span class="pl-k">-&gt;</span>setKinds([<span class="pl-smi">$kind</span>]);</span>
<span class="pl-s1"><span class="pl-c">//   - set the limit</span></span>
<span class="pl-s1"><span class="pl-smi">$query</span><span class="pl-k">-&gt;</span>setLimit(<span class="pl-c1">10</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// add the query to the request and make the request</span></span>
<span class="pl-s1"><span class="pl-smi">$request</span><span class="pl-k">-&gt;</span>setQuery(<span class="pl-smi">$query</span>);</span>
<span class="pl-s1"><span class="pl-smi">$response</span> <span class="pl-k">=</span> <span class="pl-smi">$datastore</span><span class="pl-k">-&gt;</span><span class="pl-smi">projects</span><span class="pl-k">-&gt;</span>runQuery(<span class="pl-s"><span class="pl-pds">'</span>YOUR_DATASET_ID<span class="pl-pds">'</span></span>, <span class="pl-smi">$request</span>);</span></pre></div>

<p>The method used is a matter of preference, but <em>it will be very difficult to use this library without first understanding the JSON syntax for the API</em>, so it is recommended to look at the <a href="https://developers.google.com/apis-explorer/#p/">APIs Explorer</a> before using any of the services here.</p>

<h3>
<a id="making-http-requests-directly" class="anchor" href="#making-http-requests-directly" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Making HTTP Requests Directly</h3>

<p>If Google Authentication is desired for external applications, or a Google API is not available yet in this library, HTTP requests can be made directly.</p>

<p>The <code>authorize</code> method returns an authorized <a href="http://docs.guzzlephp.org/">Guzzle Client</a>, so any request made using the client will contain the corresponding authorization.</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// create the Google client</span></span>
<span class="pl-s1"><span class="pl-smi">$client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Client</span>();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">/**</span></span>
<span class="pl-s1"><span class="pl-c"> * Set your method for authentication. Depending on the API, This could be</span></span>
<span class="pl-s1"><span class="pl-c"> * directly with an access token, API key, or (recommended) using</span></span>
<span class="pl-s1"><span class="pl-c"> * Application Default Credentials.</span></span>
<span class="pl-s1"><span class="pl-c"> */</span></span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>useApplicationDefaultCredentials();</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>addScope(<span class="pl-c1">Google_Service_Plus</span><span class="pl-k">::</span><span class="pl-c1">PLUS_ME</span>);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// returns a Guzzle HTTP Client</span></span>
<span class="pl-s1"><span class="pl-smi">$httpClient</span> <span class="pl-k">=</span> <span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>authorize();</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-c">// make an HTTP request</span></span>
<span class="pl-s1"><span class="pl-smi">$response</span> <span class="pl-k">=</span> <span class="pl-smi">$httpClient</span><span class="pl-k">-&gt;</span>get(<span class="pl-s"><span class="pl-pds">'</span>https://www.googleapis.com/plus/v1/people/me<span class="pl-pds">'</span></span>);</span></pre></div>

<h3>
<a id="caching" class="anchor" href="#caching" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Caching</h3>

<p>It is recommended to use another caching library to improve performance. This can be done by passing a <a href="http://www.php-fig.org/psr/psr-6/">PSR-6</a> compatible library to the client:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$cache</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Stash\</span><span class="pl-c1">Pool</span>(<span class="pl-k">new</span> <span class="pl-c1">Stash\Driver\</span><span class="pl-c1">FileSystem</span>);</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setCache(<span class="pl-smi">$cache</span>);</span></pre></div>

<p>In this example we use <a href="http://www.stashphp.com/">StashPHP</a>. Add this to your project with composer:</p>

<pre><code>composer require tedivm/stash
</code></pre>

<h3>
<a id="updating-tokens" class="anchor" href="#updating-tokens" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Updating Tokens</h3>

<p>When using <a href="https://developers.google.com/identity/protocols/OAuth2InstalledApp#refresh">Refresh Tokens</a> or <a href="https://developers.google.com/identity/protocols/OAuth2ServiceAccount#overview">Service Account Credentials</a>, it may be useful to perform some action when a new access token is granted. To do this, pass a callable to the <code>setTokenCallback</code> method on the client:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-smi">$logger</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Monolog\</span><span class="pl-c1">Logger</span>;</span>
<span class="pl-s1"><span class="pl-smi">$tokenCallback</span> <span class="pl-k">=</span> <span class="pl-k">function</span> (<span class="pl-smi">$cacheKey</span>, <span class="pl-smi">$accessToken</span>) <span class="pl-k">use</span> (<span class="pl-smi">$logger</span>) {</span>
<span class="pl-s1">  <span class="pl-smi">$logger</span><span class="pl-k">-&gt;</span>debug(<span class="pl-c1">sprintf</span>(<span class="pl-s"><span class="pl-pds">'</span>new access token received at cache key %s<span class="pl-pds">'</span></span>, <span class="pl-smi">$cacheKey</span>));</span>
<span class="pl-s1">};</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setTokenCallback(<span class="pl-smi">$tokenCallback</span>);</span></pre></div>

<h3>
<a id="debugging-your-http-request-using-charles" class="anchor" href="#debugging-your-http-request-using-charles" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Debugging Your HTTP Request using Charles</h3>

<p>It is often very useful to debug your API calls by viewing the raw HTTP request. This library supports the use of <a href="https://www.charlesproxy.com/documentation/getting-started/">Charles Web Proxy</a>. Download and run Charles, and then capture all HTTP traffic through Charles with the following code:</p>

<div class="highlight highlight-text-html-php"><pre><span class="pl-s1"><span class="pl-c">// FOR DEBUGGING ONLY</span></span>
<span class="pl-s1"><span class="pl-smi">$httpClient</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">GuzzleHttp\</span><span class="pl-c1">Client</span>([</span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>proxy<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">'</span>localhost:8888<span class="pl-pds">'</span></span>, <span class="pl-c">// by default, Charles runs on localhost port 8888</span></span>
<span class="pl-s1">    <span class="pl-s"><span class="pl-pds">'</span>verify<span class="pl-pds">'</span></span> <span class="pl-k">=&gt;</span> <span class="pl-c1">false</span>, <span class="pl-c">// otherwise HTTPS requests will fail.</span></span>
<span class="pl-s1">]);</span>
<span class="pl-s1"></span>
<span class="pl-s1"><span class="pl-smi">$client</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-c1">Google_Client</span>();</span>
<span class="pl-s1"><span class="pl-smi">$client</span><span class="pl-k">-&gt;</span>setHttpClient(<span class="pl-smi">$httpClient</span>);</span></pre></div>

<p>Now all calls made by this library will appear in the Charles UI.</p>

<p>One additional step is required in Charles to view SSL requests. Go to <strong>Charles &gt; Proxy &gt; SSL Proxying Settings</strong> and add the domain you'd like captured. In the case of the Google APIs, this is usually <code>*.googleapis.com</code>.</p>

<h3>
<a id="service-specific-examples" class="anchor" href="#service-specific-examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Service Specific Examples</h3>

<p>YouTube: <a href="https://github.com/youtube/api-samples/tree/master/php">https://github.com/youtube/api-samples/tree/master/php</a></p>

<h2>
<a id="how-do-i-contribute" class="anchor" href="#how-do-i-contribute" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How Do I Contribute?</h2>

<p>Please see the <a href="CONTRIBUTING.md">contributing</a> page for more information. In particular, we love pull requests - but please make sure to sign the <a href="https://developers.google.com/api-client-library/php/contribute">contributor license agreement</a>.</p>

<h2>
<a id="frequently-asked-questions" class="anchor" href="#frequently-asked-questions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Frequently Asked Questions</h2>

<h3>
<a id="what-do-i-do-if-something-isnt-working" class="anchor" href="#what-do-i-do-if-something-isnt-working" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What do I do if something isn't working?</h3>

<p>For support with the library the best place to ask is via the google-api-php-client tag on StackOverflow: <a href="http://stackoverflow.com/questions/tagged/google-api-php-client">http://stackoverflow.com/questions/tagged/google-api-php-client</a></p>

<p>If there is a specific bug with the library, please <a href="https://github.com/google/google-api-php-client/issues">file a issue</a> in the Github issues tracker, including an example of the failing code and any specific errors retrieved. Feature requests can also be filed, as long as they are core library requests, and not-API specific: for those, refer to the documentation for the individual APIs for the best place to file requests. Please try to provide a clear statement of the problem that the feature would address.</p>

<h3>
<a id="i-want-an-example-of-x" class="anchor" href="#i-want-an-example-of-x" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>I want an example of X!</h3>

<p>If X is a feature of the library, file away! If X is an example of using a specific service, the best place to go is to the teams for those specific APIs - our preference is to link to their examples rather than add them to the library, as they can then pin to specific versions of the library. If you have any examples for other APIs, let us know and we will happily add a link to the README above!</p>

<h3>
<a id="why-do-you-still-support-52" class="anchor" href="#why-do-you-still-support-52" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why do you still support 5.2?</h3>

<p>When we started working on the 1.0.0 branch we knew there were several fundamental issues to fix with the 0.6 releases of the library. At that time we looked at the usage of the library, and other related projects, and determined that there was still a large and active base of PHP 5.2 installs. You can see this in statistics such as the PHP versions chart in the WordPress stats: <a href="http://wordpress.org/about/stats/">http://wordpress.org/about/stats/</a>. We will keep looking at the types of usage we see, and try to take advantage of newer PHP features where possible.</p>

<h3>
<a id="why-does-google__service-have-weird-names" class="anchor" href="#why-does-google__service-have-weird-names" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Why does Google_..._Service have weird names?</h3>

<p>The _Service classes are generally automatically generated from the API discovery documents: <a href="https://developers.google.com/discovery/">https://developers.google.com/discovery/</a>. Sometimes new features are added to APIs with unusual names, which can cause some unexpected or non-standard style naming in the PHP classes.</p>

<h3>
<a id="how-do-i-deal-with-non-json-response-types" class="anchor" href="#how-do-i-deal-with-non-json-response-types" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How do I deal with non-JSON response types?</h3>

<p>Some services return XML or similar by default, rather than JSON, which is what the library supports. You can request a JSON response by adding an 'alt' argument to optional params that is normally the last argument to a method call:</p>

<pre><code>$opt_params = array(
  'alt' =&gt; "json"
);
</code></pre>

<h3>
<a id="how-do-i-set-a-field-to-null" class="anchor" href="#how-do-i-set-a-field-to-null" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>How do I set a field to null?</h3>

<p>The library strips out nulls from the objects sent to the Google APIs as its the default value of all of the uninitialised properties. To work around this, set the field you want to null to <code>Google_Model::NULL_VALUE</code>. This is a placeholder that will be replaced with a true null when sent over the wire.</p>

<h2>
<a id="code-quality" class="anchor" href="#code-quality" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Code Quality</h2>

<p>Run the PHPUnit tests with PHPUnit. You can configure an API key and token in BaseTest.php to run all calls, but this will require some setup on the Google Developer Console.</p>

<pre><code>phpunit tests/
</code></pre>

<h3>
<a id="coding-style" class="anchor" href="#coding-style" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Coding Style</h3>

<p>To check for coding style violations, run</p>

<pre><code>vendor/bin/phpcs src --standard=style/ruleset.xml -np
</code></pre>

<p>To automatically fix (fixable) coding style violations, run</p>

<pre><code>vendor/bin/phpcbf src --standard=style/ruleset.xml
</code></pre>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/chainoy/google-api-php-client">Google-api-php-client</a> is maintained by <a href="https://github.com/chainoy">chainoy</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
